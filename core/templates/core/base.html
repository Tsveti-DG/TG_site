{% load static %}
<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–ì "–í–∞—Å–∏–ª –ê–ø—Ä–∏–ª–æ–≤" - –ß–µ—Ä–≤–µ–Ω –±—Ä—è–≥</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700;800&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet"> -->
    <!-- style="font-size: 12pt; font-family: comic sans ms, sans-serif;" -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />

    <link rel="stylesheet" href="{% static 'assets/css/site.css' %}">

    {% block sliderlink %}
    {% endblock %}
</head>
<body>

    {% include "core/includes/topbar.html" %}
    {% include "core/includes/header.html" %}
    {% include 'core/includes/nav.html' %}

    <div>
        {% block slider %}{% endblock %}
    </div>

    <main class="site-content">
        <div class="container">
            {% block content %}{% endblock %}
        </div>
    </main>

    {% include 'core/includes/footer.html' %}

    <script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>
    <script>
        const lightbox = GLightbox({
            touchNavigation: true,
            loop: true,
            zoomable: true,
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const imgs = document.querySelectorAll(".rich-gallery img");

            imgs.forEach((img, index) => {
                const delay = index * 120; // stagger: –≤—Å—è–∫–∞ —Å–ª–µ–¥–≤–∞—â–∞ –µ +120ms

                if (img.complete) {
                    setTimeout(() => img.classList.add("loaded"), delay);
                } else {
                    img.addEventListener("load", () => {
                        setTimeout(() => img.classList.add("loaded"), delay);
                    });
                }
            });
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const toggles = document.querySelectorAll(".toggle-contact");

            toggles.forEach(link => {
                link.addEventListener("click", function (e) {
                    if (window.innerWidth > 768) return;

                    e.preventDefault();
                    e.stopPropagation();

                    // –∑–∞—Ç–≤–∞—Ä—è–º–µ –¥—Ä—É–≥–∏—Ç–µ
                    toggles.forEach(l => {
                        if (l !== link) {
                            l.classList.remove("active");
                        }
                    });

                    // toggle –Ω–∞ —Ç–µ–∫—É—â–∏—è
                    link.classList.toggle("active");
                });
            });

            // üëâ tap –∏–∑–≤—ä–Ω –∏–∫–æ–Ω–∫–∏—Ç–µ –∑–∞—Ç–≤–∞—Ä—è –≤—Å–∏—á–∫–æ
            document.addEventListener("click", function () {
                toggles.forEach(l => l.classList.remove("active"));
            });
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const dropdownItems = document.querySelectorAll(".has-dropdown");
            const isTouch = window.matchMedia("(hover: none)").matches;

            // –ø—Ä–µ–¥–ø–∞–∑–≤–∞ –æ—Ç "–æ—Ç–≤–∞—Ä—è –∏ –≤–µ–¥–Ω–∞–≥–∞ –∑–∞—Ç–≤–∞—Ä—è"
            let justToggled = false;

            dropdownItems.forEach(item => {
                const link = item.querySelector(":scope > a");

                // —Å–∞–º–æ –∑–∞ touch —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
                link.addEventListener("click", function (e) {
                    if (!isTouch) return;

                    e.preventDefault();
                    e.stopPropagation();

                    justToggled = true;
                    setTimeout(() => { justToggled = false; }, 0);

                    const isOpen = item.classList.contains("open");

                    // –∑–∞—Ç–≤–∞—Ä—è–º–µ –≤—Å–∏—á–∫–∏
                    dropdownItems.forEach(other => other.classList.remove("open"));

                    // –≤—Ç–æ—Ä–∏ —Ç–∞–ø –≤—ä—Ä—Ö—É —Å—ä—â–∏—è ‚Üí –∑–∞—Ç–≤–∞—Ä—è (–æ—Å—Ç–∞–≤—è–º–µ –≤—Å–∏—á–∫–∏ –∑–∞—Ç–≤–æ—Ä–µ–Ω–∏)
                    if (!isOpen) {
                        item.classList.add("open");
                    }
                });
            });

            // tap/click –∏–∑–≤—ä–Ω –Ω–∞–≤–∏–≥–∞—Ü–∏—è—Ç–∞ ‚Üí –∑–∞—Ç–≤–∞—Ä—è –≤—Å–∏—á–∫–æ
            document.addEventListener("click", function (e) {
                if (justToggled) return;

                if (!e.target.closest(".main-nav")) {
                    dropdownItems.forEach(item => item.classList.remove("open"));
                }
            });
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const nav = document.querySelector(".main-nav");
            const toggle = document.querySelector(".mobile-nav-toggle");

            if (!nav || !toggle) return;

            toggle.addEventListener("click", function (e) {
                e.stopPropagation();

                nav.classList.toggle("mobile-open");
                toggle.classList.toggle("is-open");

                const expanded = toggle.classList.contains("is-open");
                toggle.setAttribute("aria-expanded", expanded);
            });

            document.addEventListener("click", function (e) {
                // –∑–∞—Ç–≤–∞—Ä—è–º–µ –°–ê–ú–û –∞–∫–æ tap-—ä—Ç –µ –∏–∑–≤—ä–Ω nav
                if (!e.target.closest(".main-nav")) {
                    nav.classList.remove("mobile-open");
                    toggle.classList.remove("is-open");
                    toggle.setAttribute("aria-expanded", "false");
                }
            });
        });        
    </script>

</body>
</html>
